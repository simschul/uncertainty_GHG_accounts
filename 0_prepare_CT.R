#' 
#' 
#'  
#' @author Simon Schulte
#' Date: 2023-11-07 17:18:12.741338
#' 
#' Content:
#'  


############################################################################## # 
##### load packages ############################################################
############################################################################## # 

library(data.table)
library(tidyverse)
library(units)
library(ggforce)
library(logr)
library(readxl)
library(data.tree)

############################################################################## # 
##### general settings #################################################################
############################################################################## # 

# source utils
source(file.path('src', 'functions.R'))
# read config and setup log script
config <- setup_config_and_log()

path2output <- config$path2output

############################################################################## # 
##### settings #################################################################
############################################################################## # 


############################################################################## # 
##### functions #################################################################
############################################################################## # 
source(file.path('src', 'functions_CT.R'))
source(file.path('src', 'functions_trees.R'))


############################################################################## # 
##### load data #############################################################
############################################################################## # 
ct <- parse_CT(config$path2CT_CRF_EXIOBASE, 
         type = 'UNFCCC')
ct_coherent <- make_CT_coherent(ct)

ct_edgar <- parse_CT(config$path2CT_EDGAR_EXIOBASE, type= 'EDGAR')

############################################################################## # 
##### save results #############################################################
############################################################################## # 
save_results(ct_coherent, suffix='_UNFCCC')
save_results(ct_edgar, suffix='_EDGAR')

log_close()
# THE END ---------------------------------------------------------------------
